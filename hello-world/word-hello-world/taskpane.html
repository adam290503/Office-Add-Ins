<!DOCTYPE html>
<html>
<head>
  <title>Taskpane</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <h1>Hello World Add-in</h1>
  <button id="writeButton">Write</button>
  <button id="protectButton">Protect</button>

  <script>
    // Ensure Office is initialized
    Office.onReady(function (info) {
      if (info.host === Office.HostType.Word) {
        document.getElementById("writeButton").onclick = writeHelloWorlds;
        document.getElementById("protectButton").onclick = protectContent;
      }
    });

    // Function to write a paragraph of "Hello world"
    async function writeHelloWorlds() {
      await Word.run(async (context) => {
        const body = context.document.body;
        body.insertParagraph("Hello world. Hello world. Hello world.", Word.InsertLocation.end);
        await context.sync();
      });
    }

    // Function to protect content by converting it to '1's
    async function protectContent() {
      await Word.run(async (context) => {
        const body = context.document.body;
        body.load("text");
        await context.sync();

        // Convert the text to '1's
        const originalText = body.text;
        const protectedText = originalText.replace(/./g, "1");
        body.clear();
        body.insertText(protectedText, Word.InsertLocation.start);
        await context.sync();
      });
    }
  </script>
</body>
</html>
